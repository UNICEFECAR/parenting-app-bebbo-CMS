--- src/Controller/WellKnownController.php.orig	2025-10-06 14:05:20.698067254 +0530
+++ src/Controller/WellKnownController.php	2025-10-06 14:05:59.875277487 +0530
@@ -33,24 +33,40 @@
 
     $body = [];
     $android_packages = $config->get('android_packages');
+
     if (!empty($android_packages)) {
       foreach ($android_packages as $android_package) {
-        $item = [
-          'relation' => [
-            'delegate_permission/common.handle_all_urls',
-          ],
-          'target' => [
+        if (is_array($android_package)) {
+          $target = [
             'namespace' => 'android_app',
-            'package_name' => $android_package['package_name'],
-            'sha256_cert_fingerprints' => explode(PHP_EOL, $android_package['sha256_cert_fingerprints']),
-          ],
-        ];
-
-        $body[] = $item;
+            'package_name' => $android_package['package_name'], // Ensure this is just a string
+            'sha256_cert_fingerprints' => explode(PHP_EOL, $android_package['sha256_cert_fingerprints']), // This is now an array
+          ];
+          $relation = ['delegate_permission/common.handle_all_urls','delegate_permission/common.get_login_creds',];
+          $body[] = [
+            'relation' => $relation,
+            'target' => $target,
+          ];
+        }
       }
     }
 
-    $response = new CacheableJsonResponse(json_encode($body, JSON_UNESCAPED_SLASHES), 200, [], TRUE);
+    /* Kosovo Details */
+    $kosovo_package_name = $config->get('kosovo_package_name');
+    if (!empty($kosovo_package_name)) {
+      $kosovo_target = [
+        'namespace' => 'android_app',
+        'package_name' => $kosovo_package_name,
+        'sha256_cert_fingerprints' => explode(PHP_EOL, $config->get('kosovo_sha256_cert_fingerprints')),
+      ];
+      $kosovo_relation = ['delegate_permission/common.handle_all_urls','delegate_permission/common.get_login_creds',];
+      $body[] = [
+        'relation' => $kosovo_relation,
+        'target' => $kosovo_target,
+      ];
+    }
+
+    $response = new CacheableJsonResponse(json_encode($body, JSON_PRETTY_PRINT | JSON_UNESCAPED_SLASHES), 200, [], TRUE);
     $response->addCacheableDependency($cacheMeta);
     return $response;
   }
@@ -115,43 +131,74 @@
     // Handle caching.
     $cacheMeta = new CacheableMetadata();
     $cacheMeta->addCacheTags($config->getCacheTags());
-    $applinks = $config->get('applinks');
 
-    if (!empty($applinks)) {
-      $body['applinks'] = [
-        'apps' => [],
+    $prod_details = [];
+
+    // Get main app configuration
+    $appID = $config->get('appID');
+    if (empty($appID)) {
+      throw new CacheableNotFoundHttpException($cacheMeta);
+    }
+
+    /* UAT app config details */
+    $appID_Test = $config->get('appID_Test');
+    if(!empty($appID_Test)){
+      $app_test_path = explode(PHP_EOL, $config->get('paths_Test'));
+      $prod_details[] = [
+        'appID' => $appID_Test,
+        'components' => [ [
+          '/' => $app_test_path[0],
+          'comment' => "Matches any URL whose path starts with URL_PATH and instructs the system not to open it as a universal link"
+        ]],
+        'paths' => explode(PHP_EOL, $config->get('paths_Test'))
+      ];
+    }
+
+    /* Prod app config details */
+    $component_path = explode(PHP_EOL, $config->get('paths'));
+    $prod_details[] = [
+      'appID' => $appID,
+      'components' => [ [
+        '/' => $component_path[0],
+        'comment' => "Matches any URL whose path starts with URL_PATH and instructs the system not to open it as a universal link"
+      ]],
+      'paths' => explode(PHP_EOL, $config->get('paths'))
+    ];
+
+    /* Kosovo app config details */
+    $kosovo_appID_Test = $config->get('kosovo_appID_Test');
+    if(!empty($kosovo_appID_Test)){
+      $kosovo_paths_Test = explode(PHP_EOL, $config->get('kosovo_paths_Test'));
+      $prod_details[] = [
+        'appID' => $kosovo_appID_Test,
+        'components' => [ [
+          '/' => $kosovo_paths_Test[0],
+          'comment' => "Matches any URL whose path starts with URL_PATH and instructs the system not to open it as a universal link"
+        ]],
+        'paths' => explode(PHP_EOL, $config->get('kosovo_paths_Test'))
       ];
-      $details = [];
-      foreach ($applinks as $applink) {
-        $components_json = '';
-        $appID = $applink['appID'];
-        if (!empty($appID)) {
-          $components = $applink['components'] ?? '';
-          if (!empty($components)) {
-            $file = File::load($components);
-            if ($file) {
-              $components_json = json_decode(file_get_contents($file->getFileUri()), TRUE);
-            }
-          }
-          $def_val_arr = [];
-          if (!empty($applink['defaults'])) {
-            foreach (explode(PHP_EOL, $applink['defaults']) as $def_val) {
-              list($key, $val) = explode(':', $def_val);
-              $def_val_arr[trim($key)] = (boolean) trim($val);
-            }
-          }
-          $details[] = array_filter([
-            'appID' => $appID,
-            'paths' => $applink['paths'] ? explode(PHP_EOL, $applink['paths']) : '',
-            'appIDs' => $applink['appIDs'],
-            'components' => $components_json ?? '',
-            'defaults' => $def_val_arr ?? '',
-          ]);
-        }
-      }
-      $body['applinks']['details'] = $details;
     }
 
+    $kosovo_appID = $config->get('kosovo_appID');
+    if(!empty($kosovo_appID)){
+      $kosovo_paths = explode(PHP_EOL, $config->get('kosovo_paths'));
+      $prod_details[] = [
+        'appID' => $kosovo_appID,
+        'components' => [ [
+          '/' => $kosovo_paths[0],
+          'comment' => "Matches any URL whose path starts with URL_PATH and instructs the system not to open it as a universal link"
+        ]],
+        'paths' => explode(PHP_EOL, $config->get('kosovo_paths'))
+      ];
+    }
+
+    $body = [
+      'applinks' => [
+        'apps' => [],
+        'details' => $prod_details,
+      ],
+    ];
+
     $appClips = $config->get('appclips');
     if (!empty($appClips)) {
       $body['appclips'] = [
@@ -161,7 +208,7 @@
       ];
     }
 
-    $response = new CacheableJsonResponse(json_encode($body, JSON_UNESCAPED_SLASHES), 200, [], TRUE);
+    $response = new CacheableJsonResponse(json_encode($body, JSON_PRETTY_PRINT | JSON_UNESCAPED_SLASHES), 200, [], TRUE);
     $response->addCacheableDependency($cacheMeta);
     return $response;
   }